#!/bin/sh

echo "🔄 커밋 메시지 검사 중..."

# 머지 커밋인지 확인
if grep -q "^Merge " "$1"; then
  echo "🔄 머지 커밋 감지: 컨벤션 체크 스킵"
  exit 0
fi

COMMIT_MESSAGE_FILE=$1
COMMIT_MESSAGE=$(cat "$COMMIT_MESSAGE_FILE")

# 커밋 타입 정의
VALID_TYPES="feat|refactor|fix|chore|style|test"

# 커밋 메시지 형식 검사
if ! echo "$COMMIT_MESSAGE" | grep -qE "^($VALID_TYPES): "; then
  echo "❌ 커밋 메시지는 다음 형식 중 하나로 시작해야 합니다:"
  echo "  - feat: 새로운 기능 추가"
  echo "  - refactor: 코드 리팩토링"
  echo "  - fix: 버그 수정"
  echo "  - chore: 빌드 프로세스 또는 보조 도구 변경"
  echo "  - style: 코드 스타일 변경 (포맷팅, 세미콜론 등)"
  echo "  - test: 테스트 코드 추가 또는 수정"
  exit 1
fi

echo "🔆 Thanks for keeping the convention 🔆"